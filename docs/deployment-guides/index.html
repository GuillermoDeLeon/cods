<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Deployment Guides</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_deployment_guides">Deployment Guides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains step-by-step walkthroughs for common deployment scenarios.</p>
</div>
<div class="paragraph">
<p>All of these guides assume the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#initial-server-setup">A server setup with cods</a></p>
</li>
<li>
<p><a href="#dns-configuration">DNS records properly configured</a></p>
</li>
<li>
<p>A working application</p>
<div class="paragraph">
<p>That is, your application should run locally and be free from errors.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Further, we assume that your server command is named <code>myserver</code>.</p>
</div>
<div class="sect2">
<h3 id="_static_site">Static Site</h3>
<div class="paragraph">
<p>This section will walk you through creating and deploying a static site with
<code>cods</code>.
A prerequisite for this guide is a server command setup with cods, we will
assume the command is named <code>myserver</code>.
This guide is written for a "plain" static site, that is, a site where the
contents of the repository should just be served to the public and there is no
backend or build process.</p>
</div>
<div class="sect3">
<h4 id="_create_the_site">Create The Site</h4>
<div class="paragraph">
<p>This section will walk you through creating a (<strong><em>very</em></strong>) basic static
site and initializing a git repository. Skip this section if you have an
existing project you want to deploy.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an <code>index.html</code> file.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You site could be more complex, but let’s start by creating an
<code>index.html</code> file. This will be the home page for your domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!doctype html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"/&gt;
    &lt;title&gt;My Website&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello From Cods!&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Initialize the git repository</p>
<div class="literalblock">
<div class="content">
<pre>git init
git add index.html
git commit -m 'First Commit'</pre>
</div>
</div>
</li>
<li>
<p>(Optionally) push your repository up to GitHub.</p>
<div class="paragraph">
<p>Go to <a href="https://github.com/new">github.com/new</a> and create a repo, then add
the remote and push.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git remote add origin ...
git push origin master</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_create_the_site_2">Create The Site</h4>
<div class="paragraph">
<p>Next we will setup your server to host the site. Run the command below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site create --domain example.com --static</pre>
</div>
</div>
<div class="paragraph">
<p>replacing <code>example.com</code> with your domain name (or a subdomain).</p>
</div>
</div>
<div class="sect3">
<h4 id="_push_to_deploy">Push To Deploy</h4>
<div class="paragraph">
<p>After the site creation command above finishes, you should see some
output that gives you a copy-pastable <code>git</code> command to add a
<code>production</code> remote to your repository.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can find this command by running</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver info --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Either way after running the command to add the production remote, go
ahead and push:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git push production master</pre>
</div>
</div>
<div class="paragraph">
<p>After pushing, you should see your site live!</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot">Spring Boot</h3>
<div class="sect3">
<h4 id="_get_your_application_ready_for_deployment">Get Your Application Ready For Deployment</h4>
<div class="paragraph">
<p>This tool is setup to host any web application that is packaged as a
<code>jar</code> that is <code>`self-contained'', meaning that it does not depend on
an external application server like tomcat. Previously we have just been
running the `+main+</code> method in our application, but Spring boot will
also allow us to package our application as a <code>jar</code> and run it.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="0">
<li>
<p>Make sure you have committed all changes and your application is free
from errors.</p>
</li>
<li>
<p>If your application is using spring boot v1.x and you have multiple
versions of Java installed on your machine,
<a href="faq.md#do-i-need-to-do-anything-differently-if-i-have-multiple-java-installations">see
the FAQ here</a></p>
</li>
<li>
<p>Skip Tests</p>
<div class="paragraph">
<p>Unless you’ve built out testing for your application, you’ll want to add
the <code>skipTests</code> element below to your <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">...
&lt;properties&gt;
    ...
    &lt;skipTests&gt;true&lt;/skipTests&gt;
    ...
&lt;/properties&gt;
...</code></pre>
</div>
</div>
</li>
<li>
<p>Package the application as a jar</p>
<div class="paragraph">
<p>From the root of your project, run the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./mvnw package</pre>
</div>
</div>
<div class="paragraph">
<p>This will package your application and turn it into one big <code>.jar</code>
file, which will be output to the <code>target</code> directory.</p>
</div>
<div class="paragraph">
<p>If any error occur after running this command, read the error messages,
fix them, and try running it again.</p>
</div>
<div class="paragraph">
<p>You can find the path to your output jar file by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>find target -name \*.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Take note of this filepath, as we will reference it again.</p>
</div>
</li>
<li>
<p>Run the application from the command line</p>
<div class="paragraph">
<p>To more closely mimick the way in which your application will run in
production, we’ll run it from the command line and ensure everything is
working the right way.</p>
</div>
<div class="paragraph">
<p>The command below will run the jar file that was produced in the last
step:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar YOUR_JAR_FILE</pre>
</div>
</div>
<div class="paragraph">
<p>Replacing <code>YOUR_JAR_FILE</code> with the filepath you found in the previous
step. For example, the command might look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar target/codeup-blog-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>This will start up the web server in a similar way that running the main
method from your IDE does.</p>
</div>
<div class="paragraph">
<p>Open up the application in your browser and ensure that everything is
still running the way you want it to. Once you are satisfied, press
Ctrl-C in your terminal to stop the server.</p>
</div>
</li>
<li>
<p>Setup the <code>.cods</code> file</p>
<div class="paragraph">
<p>Create a file in the root of your project named <code>.cods</code>. This file is
what tells the server how to build our project. This file should have
the following contents:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>BUILD_COMMAND='./mvnw package'
JAR_FILE=target/blog-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Your jar file path could be different depending on how you named your
project. Again here you should use the filepath you found in the
previous step.</p>
</div>
<div class="paragraph">
<p>You can test that your <code>.cods</code> file is setup correctly by running the
following commands in your terminal from the root of your project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>source .cods
eval "$BUILD_COMMAND"
[[ -f $JAR_FILE ]] &amp;&amp; echo 'Good to Go!' || echo 'JAR_FILE not found!'</pre>
</div>
</div>
<div class="paragraph">
<p>You should see no output from the first command, your project should
build successfully after the second, and your should see ``Good to Go!''
output after the third.</p>
</div>
<div class="paragraph">
<p>Once everything is ready to go, make sure to add and commit the
<code>.cods</code> file!</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_site_setup">Site Setup</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a database for your site</p>
<div class="literalblock">
<div class="content">
<pre>myserver db create --name blog_db --user blog_user</pre>
</div>
</div>
</li>
<li>
<p>Setup your site</p>
<div class="paragraph">
<p>This will prep the server to host your site. You will be prompted for
your <em>server admin</em> password.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site create --domain example.com --java --spring-boot --port 8080</pre>
</div>
</div>
<div class="paragraph">
<p>We’ll choose 8080 for the port number here, but if you deploy more than
one site, you will need to choose a different port number for each one
(e.g. 8000 or 8888). You can run <code>myserver ports</code> to view the ports
that are being used on your server.</p>
</div>
<div class="paragraph">
<p>If the DNS records are improperly configured, the script will warn you,
you can go ahead and continue, you just won’t be able to see your site
until the records are properly configured.</p>
</div>
<div class="paragraph">
<p>We’ll pass the <code>--spring-boot</code> flag to automatically take care of some
common configuration for a spring boot application.</p>
</div>
</li>
<li>
<p>Create the production <code>application.properties</code> file</p>
<div class="paragraph">
<p>Since <code>application.properties</code> file is ignored by git (as it should
be), we will need to manually create this file on the server. The
database name and user that go in this file should match up with the
values you used when running the <code>db create</code> command.</p>
</div>
<div class="paragraph">
<p>You can find the password for your database user by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver credentials</pre>
</div>
</div>
<div class="paragraph">
<p>It’s usually easiest to start by copying your local
<code>application.properties</code> to the server</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd ~/IdeaProjects/springboot-blog
myserver upload --file src/main/resources/application.properties --destination /srv/example.com/application.properties</pre>
</div>
</div>
<div class="paragraph">
<p>Then changing the relevant values. That is, change the database user and
password to the ones you created in the last step.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver run nano /srv/example.com/application.properties</pre>
</div>
</div>
<div class="paragraph">
<p><em>Make sure to replace <code>example.com</code> with the name of your actual site
in the two commands above.</em></p>
</div>
<div class="paragraph">
<p>To save and exit nano:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ctrl-x</p>
</li>
<li>
<p>Type <code>y</code></p>
</li>
<li>
<p>Press Enter</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add the deployment remote to your project and push to deploy the site</p>
<div class="paragraph">
<p>You can find your deployment remote (and a copy-pasteable command to add
it to your project) by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site info --domain=example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Replacing <code>example.com</code> with the name of the site you just setup.</p>
</div>
<div class="paragraph">
<p>Copy and paste the command to add the <code>production</code> remote, and push up
to production</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git push production master</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_debugging">Debugging</h4>
<div class="paragraph">
<p>In general, debugging will fall into one of two categories, either
something goes wrong during the build process, that is, when you do a
push, or something goes wrong while the app is running, or starting up.</p>
</div>
<div class="paragraph">
<p>In general, try to reproduce any errors locally, so that your can solve
them locally, then push the fixes to production.</p>
</div>
<div class="sect4">
<h5 id="_building">Building</h5>
<div class="paragraph">
<p>If anything goes wrong during the build process, you should see the
output / error messages after running a <code>git push</code> to production.</p>
</div>
<div class="paragraph">
<p>Occasionally, you will want to re-run the build process even though you
don’t have any changes to push. In this case, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">myserver site build --domain example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>To trigger the same process that happens when you do a <code>git push</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_while_the_app_is_running">While the app is running</h5>
<div class="paragraph">
<p>Even if your application is built successfully, something might go wrong
when your application initially starts up, or at some point when it is
running. You can view the logs for your application by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>And you can watch the log file in realtime by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com --follow</pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-C to stop watching the log file.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_static_site_built_with_hugo">Static Site Built With Hugo</h3>
<div class="paragraph">
<p>This guide is written specifically for <a href="https://gohugo.io">hugo</a>, but can
be referenced for any type of static site build tool. We will walk
through the process of setting up a static site on your server that is
(re-)built whenever you <code>git push</code> to your <code>production</code> remote.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#prerequisites">Prerequisites</a></p>
</li>
<li>
<p><a href="#setup-the-site">Setup The Site</a></p>
</li>
<li>
<p><a href="#install-hugo">Install Hugo</a></p>
</li>
<li>
<p><a href="#setting-up-the-server-site-build">Setting Up The Server Site
Build</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#the-easy-way-with-cods">The easy way with <code>.cods</code></a></p>
</li>
<li>
<p><a href="#more-customization-over-the-build-process">More customization
over the build process</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#push-to-deploy">Push To Deploy</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See also <a href="usage.md#static-site-creation">the ``Static Site Creation''
section in the usage guide</a>.</p>
</div>
<div class="sect3">
<h4 id="_prerequisites">Prerequisites</h4>
<div class="ulist">
<ul>
<li>
<p>A server setup with cods. <a href="initial-server-setup.md">See the initial
server setup guide here</a>. We’ll assume the command name is <code>myserver</code>.</p>
</li>
<li>
<p>DNS Records for the domain you wish to deploy to configured properly.
Check out <a href="dns-configuration.md">the DNS configuration guide here</a>.</p>
</li>
<li>
<p>A working hugo application. That is, you should be able to build and
view your static site locally.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_setup_the_site">Setup The Site</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the command to create the site</p>
<div class="literalblock">
<div class="content">
<pre>myserver site create --static --domain example.com</pre>
</div>
</div>
</li>
<li>
<p>Add the git remote to your project</p>
<div class="literalblock">
<div class="content">
<pre>git remote add production ...</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_install_hugo">Install Hugo</h4>
<div class="paragraph">
<p>Even though you might have hugo (or whatever other build tool you are
using) installed on your laptop, you’ll also need to install hugo on
your server.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver run sudo apt-get install hugo</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_up_the_server_site_build">Setting Up The Server Site Build</h4>
<div class="paragraph">
<p>Next we’ll setup some configuration so that whenever you push to
<code>production</code>, your build process is triggered and the site is
deployed.</p>
</div>
<div class="sect4">
<h5 id="_the_easy_way_with_cods">The easy way with <code>.cods</code></h5>
<div class="paragraph">
<p>If your build process consists of running a single command, and the
output of your build is a single directory that contains the contents of
your site, you can setup a <code>.cods</code> file that explains this to the
server.</p>
</div>
<div class="paragraph">
<p>Create a file named <code>.cods</code> at the root of your project with the
following contents:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>BUILD_COMMAND='hugo'
OUTPUT_DIR=public</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_more_customization_over_the_build_process">More customization over the build process</h5>
<div class="paragraph">
<p>If you need to do something more custom, that is, you need to run more
commands than what is described above, you can create a file named
<code>cods.sh</code>, and whatever commands are in this file will be run whenever
you push to production.</p>
</div>
<div class="paragraph">
<p>For example, if you are using a theme with hugo and the theme is a git
submodule, you first need to make sure the submodule is ready to go
before you can build the site contents.</p>
</div>
<div class="paragraph">
<p>Create a file named <code>cods.sh</code> at the root of your project with the
following contents (customize to suit your needs of course):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>set -u

# clone the theme
git submodule init
git submodule update

# build the site
hugo

# do whatever else you need to do
# i.e. run any other commands

rm -f $public_dir/*
mv public/* $PUBLIC_DIR</pre>
</div>
</div>
<div class="paragraph">
<p>Here we’re assuming <code>hugo</code> builds your site, and, after running any
other custom commands, the result is a <code>public</code> directory that
contains your site’s build HTML, CSS, and JS.</p>
</div>
<div class="paragraph">
<p>The last two lines above are what actually deploy the site. $PUBLIC_DIR
is the location of the static files that are in production, and the last
two lines remove whatever is currently there, and replace it with the
contents of the <code>public</code> directory you just built.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_push_to_deploy_2">Push To Deploy</h4>
<div class="paragraph">
<p>Now that everything is in place, simply push to production to deploy
your site:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git push production master</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_node_movies_app_deployment">Node Movies App Deployment</h3>
<div class="paragraph">
<p>This section documents the process for deploying
<a href="https://github.com/gocodeup/movies-application">this sample node application</a>. In
short, this application is a node-powered API backend, combined with a frontend
that is the output of a webpack build process.</p>
</div>
<div class="sect3">
<h4 id="_make_sure_your_application_is_ready">Make sure your application is ready</h4>
<div class="paragraph">
<p>In addition to running and being error free, we’ll need to ensure 2
things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We have a <code>npm run start</code> command</p>
<div class="paragraph">
<p>Make sure you have a <code>"start"</code> entry in the <code>scripts</code> section of
your <code>package.json</code>.</p>
</div>
<div class="paragraph">
<p>For example, if you start your application by running the <code>server.js</code>
script with node, your <code>package.json</code> would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    ...
    "scripts": {
        ...
        "start": "node server.js"
        ...
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should now be able to run <code>npm run start</code> from the root of your
project and have your application startup.</p>
</div>
<div class="paragraph">
<p>Take note of the port number that your site is running on, we’ll need
this information later when we create a site.</p>
</div>
</li>
<li>
<p>Create a <code>cods.sh</code> file.</p>
<div class="paragraph">
<p>This file will tell our server what needs to be done when the site is
deployed. In our case, we’ll want to install the dependencies, and build
the static files.</p>
</div>
<div class="paragraph">
<p>Create a file in your project root named <code>cods.sh</code>. It should have the
following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">echo 'Installing dependencies'
npm install
echo 'Building static assets'
npm run build</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>We’re assuming that <code>npm run build</code> puts together your static assets.
This should be the case if you are deploying the movies application, but
if you are deploying something else, you might need to use a different
command here.</em></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_create_the_site_3">Create the site</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">myserver site create --domain example.com --node --port 3000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replacing <code>example.com</code> with the domain name you want to deploy to.</p>
</div>
<div class="paragraph">
<p>You might also need to replace <code>3000</code> here if your application runs on
a different port number.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_your_application">Deploy your application</h4>
<div class="paragraph">
<p>The command below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">myserver site info --domain example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will output the location of your production git remote, including a
copy-pastable command you can use to add the git remote to your project.
Go ahead and do so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">git remote add production ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then make sure all your changes are added and committed, then push to
production:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">git push origin master</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you push, you’ll see the <code>cods.sh</code> script running, then you
should see your site live!</p>
</div>
</div>
<div class="sect3">
<h4 id="_debugging_2">Debugging</h4>
<div class="paragraph">
<p>In general, debugging will fall into one of two categories, either
something goes wrong during the build process, that is, when you do a
push, or something goes wrong while the app is running, or starting up.</p>
</div>
<div class="paragraph">
<p>In general, try to reproduce any errors locally, so that your can solve
them locally, then push the fixes to production.</p>
</div>
<div class="sect4">
<h5 id="_building_2">Building</h5>
<div class="paragraph">
<p>If anything goes wrong during the build process, you should see the
output / error messages after running a <code>git push</code> to production.</p>
</div>
<div class="paragraph">
<p>Occasionally, you will want to re-run the build process even though you
don’t have any changes to push. In this case, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">myserver site build --domain example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>To trigger the same process that happens when you do a <code>git push</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_while_the_app_is_running_2">While the app is running</h5>
<div class="paragraph">
<p>Even if your application is built successfully, something might go wrong
when your application initially starts up, or at some point when it is
running. You can view the logs for your application by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>And you can watch the log file in realtime by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com --follow</pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-C to stop watching the log file.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_python_flask">Python Flask</h3>
<div class="sect3">
<h4 id="_application_prep">Application Prep</h4>
<div class="paragraph">
<p>In order to deploy a python application with this tool, you need to
provide a shell script, <code>start_server.sh</code> that is executable and that
starts up your web server.</p>
</div>
<div class="paragraph">
<p>We’ll also create a script that runs whenever our code is deployed that
will re-create our virtual environment.</p>
</div>
<div class="sect4">
<h5 id="_make_sure_the_application_is_ready">Make Sure the Application is Ready</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete and re-create the virtual environment.</p>
<div class="literalblock">
<div class="content">
<pre>rm -rf env
python -m venv env
source env/bin/activate
python -m pip install -r requirements.txt</pre>
</div>
</div>
</li>
<li>
<p>Run your application and ensure that everything is how you expect it
to be.</p>
<div class="paragraph">
<p>That is, make sure that your application still works the way you would
expect it to after re-creating the virtual environment and installing
dependencies.</p>
</div>
</li>
<li>
<p>Make sure your working directory is clean (i.e. all of your work has
been added and committed to git).</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_server_startup_script">Server Startup Script</h5>
<div class="paragraph">
<p>We need to create a file named <code>start_server.sh</code>. This script should
start up your application in production mode.</p>
</div>
<div class="paragraph">
<p>Here’s an example of how we might setup this script with an existing
flask application that you’d previously been running with the
<code>flask run</code> command. (If you already setup this script, you can skip
the rest of this section.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install
<a href="https://docs.pylonsproject.org/projects/waitress/en/latest/index.html"><code>waitress</code></a>.</p>
<div class="paragraph">
<p>Waitress is a python library that can serve our flask application in a
production environment.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>source env/bin/activate
python -m pip install waitress
python -m pip freeze &gt; requirements.txt</pre>
</div>
</div>
</li>
<li>
<p>Add code to use <code>waitress</code> in your application</p>
<div class="paragraph">
<p>Within the file file that defines your flask <code>app</code>, add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">if __name__ == '__main__':
    import waitress
    waitress.serve(app, port=5005)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The port number here is arbitrary, but needs to be unique to your
server, that is, if you have multiple python application deployed on
your server, they can’t use the same port number.</p>
</div>
<div class="paragraph">
<p>After adding the above code, you can start your application and serve it
with waitress by running the script above. Assuming your script is named
<code>server.py</code>, you would do so with the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python server.py</pre>
</div>
</div>
</li>
<li>
<p>Create the startup script</p>
<div class="paragraph">
<p>This script is basically a sequence of shell commands that you would use
to start up the server. We’ll also add a couple of <code>echo</code> statements
for informative output.</p>
</div>
<div class="paragraph">
<p>Take a look at the code snippet below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#!/usr/bin/env bash

set -e # cause the script to exit on any errors

echo '[start_server.sh] Activating Virtual Environment'
source env/bin/activate
echo '[start_server.sh] Starting The Server'
python server.py</pre>
</div>
</div>
<div class="paragraph">
<p>Copy the code above into a file named <code>start_server.sh</code>. If your
virtual environment is not in a directory named <code>env</code>, or your
application entrypoint is not <code>server.py</code> you’ll need to tweak the
code above, otherwise, you shouldn’t need to make any changes.</p>
</div>
</li>
<li>
<p>Make the startup script executable</p>
<div class="literalblock">
<div class="content">
<pre>chmod +x start_server.sh</pre>
</div>
</div>
</li>
<li>
<p>Add and commit the script.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_deployment_script">Deployment Script</h5>
<div class="paragraph">
<p>We will also create a file that runs whenever a new version of our code
is deployed.</p>
</div>
<div class="paragraph">
<p>Copy the following into a file named <code>cods.sh</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Script used for deployment with cods (https://github.com/zgulde/cods)
set -e

cd $SITE_DIR

echo "[cods.sh] (re-)creating the venv"
rm -rf env
python3 -m venv env
echo '[cods.sh] Activating venv and installing dependencies'
source env/bin/activate
python3 -m pip install -r requirements.txt</pre>
</div>
</div>
<div class="paragraph">
<p>By adding the script above, we will instruct our server to re-create our
application’s virtual environment and re-install dependencies whenever
we deploy a new version.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_the_site_4">Create The Site</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make note of the port number that your application runs on</p>
<div class="paragraph">
<p>The port number is arbitrary, but needs to be unique within your server,
that is, if you have multiple python application deployed on your
server, they can’t use the same port number.</p>
</div>
</li>
<li>
<p>Run the command below to setup the site:</p>
<div class="literalblock">
<div class="content">
<pre>myserver site create --python --port 5005 --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Replacing <code>5005</code> with your application’s port number, and
<code>example.com</code> with the name of the domain you are setting up
(subdomains are okay too, so long as the DNS records are setup
properly).</p>
</div>
</li>
<li>
<p>(Optionally) enable https for your site</p>
<div class="literalblock">
<div class="content">
<pre>myserver site enablehttps --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Again, replacing <code>example.com</code> with your domain.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_your_code">Deploy Your Code</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A a deployment git remote to your project</p>
<div class="literalblock">
<div class="content">
<pre>myserver site info --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Again replacing <code>example.com</code> with your domain.</p>
</div>
<div class="paragraph">
<p>You’ll see a command that you can copy and paste to add <code>production</code>
remote. Go ahead and do this.</p>
</div>
</li>
<li>
<p>Make sure all of your work is added and committed</p>
</li>
<li>
<p>Push to <code>production</code> deploy your code</p>
<div class="literalblock">
<div class="content">
<pre>git push production master</pre>
</div>
</div>
<div class="paragraph">
<p>You should see the code from your <code>cods.sh</code> file run whenever you push
to <code>production</code>.</p>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_monitoring_your_application">Monitoring Your Application</h5>
<div class="paragraph">
<p>To view the output from your application (i.e. to see <code>print</code>
statements or any errors that are produced), you’ll need to view the
logs from the server. You can do so in one of two ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>View the entire log file</p>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com</pre>
</div>
</div>
<div class="paragraph">
<p>This command will dump the contents of the logfile out to your terminal.</p>
</div>
</li>
<li>
<p>Watch the logfile in real-time</p>
<div class="literalblock">
<div class="content">
<pre>myserver site logs --domain example.com --follow</pre>
</div>
</div>
<div class="paragraph">
<p>Press Ctrl-C to stop watching the log file.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_laravel_deployment_guide">Laravel Deployment Guide</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the site</p>
<div class="literalblock">
<div class="content">
<pre>myserver site create -d php-site.com --php</pre>
</div>
</div>
</li>
<li>
<p>Create the database for your application</p>
<div class="literalblock">
<div class="content">
<pre>myserver db create -n my_database -u my_user</pre>
</div>
</div>
</li>
<li>
<p>Push to deploy</p>
<div class="literalblock">
<div class="content">
<pre>myserver site info -d php-site.com
# add the git remote
git push production master</pre>
</div>
</div>
</li>
<li>
<p>Login to finalize setup</p>
<div class="literalblock">
<div class="content">
<pre>myserver login</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /srv/php-site.com
composer install
cp .env.example .env
./artisan key:generate
# edit .env for db secrets, environment, etc</pre>
</div>
</div>
</li>
<li>
<p>Add an <code>cods.sh</code> script with <code>composer install</code> in it</p>
<div class="paragraph">
<p>Create a file in your project root named <code>cods.sh</code> with the following
contents:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>composer install</pre>
</div>
</div>
<div class="paragraph">
<p>This file will be run (i.e. <code>composer install</code> will run) whenever you
push to the production remote and deploy the site.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-04-15 20:30:13 -0500
</div>
</div>
</body>
</html>